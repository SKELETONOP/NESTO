<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= pageTitle || 'Admin Dashboard' %></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            animation: {
              'fade-in': 'fadeIn 0.5s ease-in-out',
              'slide-up': 'slideUp 0.3s ease-out',
              'pulse-subtle': 'pulse 3s infinite',
            },
            keyframes: {
              fadeIn: {
                '0%': { opacity: '0', transform: 'translateY(10px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' }
              },
              slideUp: {
                '0%': { transform: 'translateY(20px)', opacity: '0' },
                '100%': { transform: 'translateY(0)', opacity: '1' }
              }
            }
          }
        }
      }
    </script>
  </head>
  <body class="bg-gradient-to-br from-slate-50 via-indigo-50/30 to-purple-100/40 min-h-screen font-sans text-gray-800 overflow-x-hidden">
    <!-- Floating Background Elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <div class="absolute top-10 left-10 w-32 h-32 bg-gradient-to-br from-purple-200/20 to-indigo-200/20 rounded-full blur-xl animate-pulse-subtle"></div>
      <div class="absolute top-1/3 right-20 w-24 h-24 bg-gradient-to-br from-indigo-200/30 to-blue-200/30 rounded-full blur-lg animate-pulse-subtle" style="animation-delay: 1s;"></div>
      <div class="absolute bottom-20 left-1/4 w-40 h-40 bg-gradient-to-br from-purple-100/20 to-pink-100/20 rounded-full blur-2xl animate-pulse-subtle" style="animation-delay: 2s;"></div>
    </div>

    <div class="relative z-10 max-w-7xl mx-auto px-4 py-8">
      <!-- Header Section -->
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-12 animate-fade-in">
        <div class="mb-4 md:mb-0">
          <h1 class="text-5xl font-black bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 bg-clip-text text-transparent mb-2">
            <i class="fas fa-chart-line mr-3"></i>Admin Dashboard
          </h1>
          <p class="text-gray-600 text-lg font-medium">Manage your platform with ease</p>
        </div>
        <div class="flex items-center space-x-4">
          <div class="text-right hidden md:block">
            <p class="text-sm text-gray-500">Welcome back, Admin</p>
            <p class="text-xs text-gray-400">Last login: 2 hours ago</p>
          </div>
          <form action="/logout" method="POST" class="inline-block">
            <button
              type="submit"
              class="group relative px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 overflow-hidden"
            >
              <div class="absolute inset-0 bg-gradient-to-r from-red-600 to-red-700 opacity-0 group-hover:opacity-100 transition-opacity duration-200"></div>
              <span class="relative flex items-center">
                <i class="fas fa-sign-out-alt mr-2"></i>
                Logout
              </span>
            </button>
          </form>
        </div>
      </div>

      <!-- Quick Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
        <!-- Total Users Card -->
        <div class="group relative bg-white/80 backdrop-blur-sm shadow-xl rounded-3xl p-8 hover:shadow-2xl hover:scale-105 transition-all duration-300 border border-white/50 animate-slide-up">
          <div class="absolute inset-0 bg-gradient-to-br from-purple-500/5 to-indigo-500/5 rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <div class="relative flex items-center justify-between">
            <div>
              <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-2">
                Total Users
              </h3>
              <p class="text-4xl font-black text-gray-800 mb-1">
                <%= totalUsers || '1,234' %>
              </p>
              <div class="flex items-center text-sm">
                <span class="text-green-500 font-semibold">+12%</span>
                <span class="text-gray-500 ml-1">from last month</span>
              </div>
            </div>
            <div class="relative">
              <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow duration-300">
                <i class="fas fa-users text-white text-2xl"></i>
              </div>
              <div class="absolute -top-1 -right-1 w-4 h-4 bg-green-400 rounded-full animate-pulse"></div>
            </div>
          </div>
        </div>

        <!-- Total Favourites Card -->
        <div class="group relative bg-white/80 backdrop-blur-sm shadow-xl rounded-3xl p-8 hover:shadow-2xl hover:scale-105 transition-all duration-300 border border-white/50 animate-slide-up" style="animation-delay: 0.1s;">
          <div class="absolute inset-0 bg-gradient-to-br from-pink-500/5 to-red-500/5 rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <div class="relative flex items-center justify-between">
            <div>
              <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-2">
                Total Favourites
              </h3>
              <p class="text-4xl font-black text-gray-800 mb-1">
                <%= totalFavourites || '5,678' %>
              </p>
              <div class="flex items-center text-sm">
                <span class="text-green-500 font-semibold">+8%</span>
                <span class="text-gray-500 ml-1">from last month</span>
              </div>
            </div>
            <div class="relative">
              <div class="w-16 h-16 bg-gradient-to-br from-pink-500 to-red-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow duration-300">
                <i class="fas fa-heart text-white text-2xl"></i>
              </div>
              <div class="absolute -top-1 -right-1 w-4 h-4 bg-pink-400 rounded-full animate-pulse" style="animation-delay: 0.5s;"></div>
            </div>
          </div>
        </div>

        <!-- Total Bookings Card -->
        <div class="group relative bg-white/80 backdrop-blur-sm shadow-xl rounded-3xl p-8 hover:shadow-2xl hover:scale-105 transition-all duration-300 border border-white/50 animate-slide-up" style="animation-delay: 0.2s;">
          <div class="absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-teal-500/5 rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <div class="relative flex items-center justify-between">
            <div>
              <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-2">
                Total Bookings
              </h3>
              <p class="text-4xl font-black text-gray-800 mb-1">
                <%= totalBookings || '892' %>
              </p>
              <div class="flex items-center text-sm">
                <span class="text-green-500 font-semibold">+24%</span>
                <span class="text-gray-500 ml-1">from last month</span>
              </div>
            </div>
            <div class="relative">
              <div class="w-16 h-16 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow duration-300">
                <i class="fas fa-calendar-check text-white text-2xl"></i>
              </div>
              <div class="absolute -top-1 -right-1 w-4 h-4 bg-emerald-400 rounded-full animate-pulse" style="animation-delay: 1s;"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- User Management Section -->
      <div class="bg-white/90 backdrop-blur-sm shadow-2xl rounded-3xl overflow-hidden border border-white/50 animate-slide-up" style="animation-delay: 0.3s;">
        <!-- Section Header -->
        <div class="bg-gradient-to-r from-slate-800 to-slate-900 px-8 py-6">
          <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
            <div>
              <h2 class="text-2xl font-bold text-white mb-2 flex items-center">
                <i class="fas fa-users-cog mr-3 text-indigo-300"></i>
                User Management
              </h2>
              <p class="text-slate-300">Monitor and manage all registered users</p>
            </div>
            <div class="flex items-center space-x-4 mt-4 md:mt-0">
              <div class="relative">
                <input
                  type="text"
                  placeholder="Search users..."
                  class="pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-xl text-white placeholder-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent transition-all duration-200"
                  onkeyup="filterTable(this.value)"
                />
                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"></i>
              </div>
              <button class="px-4 py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-xl transition-colors duration-200 flex items-center">
                <i class="fas fa-download mr-2"></i>
                Export
              </button>
            </div>
          </div>
        </div>

        <!-- Table Container -->
        <div class="p-8">
          <div class="overflow-x-auto rounded-2xl border border-gray-200/50">
            <table class="min-w-full divide-y divide-gray-200" id="usersTable">
              <thead class="bg-gradient-to-r from-slate-50 to-slate-100">
                <tr>
                  <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                    <div class="flex items-center space-x-2">
                      <i class="fas fa-user text-indigo-500"></i>
                      <span>Full Name</span>
                    </div>
                  </th>
                  <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                    <div class="flex items-center space-x-2">
                      <i class="fas fa-envelope text-indigo-500"></i>
                      <span>Email</span>
                    </div>
                  </th>
                  <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                    <div class="flex items-center space-x-2">
                      <i class="fas fa-shield-alt text-indigo-500"></i>
                      <span>User Type</span>
                    </div>
                  </th>
                  <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                    <div class="flex items-center space-x-2">
                      <i class="fas fa-heart text-pink-500"></i>
                      <span>Favourites</span>
                    </div>
                  </th>
                  <th class="px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                    <div class="flex items-center space-x-2">
                      <i class="fas fa-calendar text-emerald-500"></i>
                      <span>Bookings</span>
                    </div>
                  </th>
                  <th class="px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider">
                    <div class="flex items-center justify-center space-x-2">
                      <i class="fas fa-cogs text-indigo-500"></i>
                      <span>Actions</span>
                    </div>
                  </th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-100">
                <% if (typeof userDetails !== 'undefined' && userDetails.length > 0) { %>
                  <% userDetails.forEach(user => { %>
                    <% if (user.userType === "admin") { %>
                      <tr class="hover:bg-red-50 transition-colors duration-200 group">
                        <td class="px-6 py-4">
                          <div class="flex items-center">
                            <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3">
                              <i class="fas fa-shield-alt text-red-600"></i>
                            </div>
                            <span class="font-semibold text-red-700">
                              <i class="fas fa-lock mr-2"></i>
                              Permission Denied
                            </span>
                          </div>
                        </td>
                        <td class="px-6 py-4 text-red-600 font-medium">Protected Account</td>
                        <td class="px-6 py-4">
                          <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-red-100 text-red-800">
                            <i class="fas fa-crown mr-2"></i>
                            Admin
                          </span>
                        </td>
                        <td class="px-6 py-4 text-gray-400">—</td>
                        <td class="px-6 py-4 text-gray-400">—</td>
                        <td class="px-6 py-4 text-center">
                          <span class="text-red-500 text-sm font-medium">Restricted</span>
                        </td>
                      </tr>
                    <% } else { %>
                      <tr class="hover:bg-indigo-50 transition-colors duration-200 group">
                        <td class="px-6 py-4">
                          <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mr-3 text-white font-bold text-sm">
                              <%= user.fullName ? user.fullName.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase() : 'NA' %>
                            </div>
                            <span class="font-semibold text-gray-800">
                              <%= user.fullName || 'N/A' %>
                            </span>
                          </div>
                        </td>
                        <td class="px-6 py-4 text-gray-600">
                          <%= user.email || 'N/A' %>
                        </td>
                        <td class="px-6 py-4">
                          <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold 
                            <% if (user.userType === 'premium') { %>bg-emerald-100 text-emerald-800<% } else { %>bg-indigo-100 text-indigo-800<% } %>">
                            <i class="fas <%= user.userType === 'premium' ? 'fa-star' : 'fa-user' %> mr-2"></i>
                            <%= user.userType ? user.userType.charAt(0).toUpperCase() + user.userType.slice(1) : 'User' %>
                          </span>
                        </td>
                        <td class="px-6 py-4">
                          <div class="flex items-center">
                            <span class="text-2xl font-bold text-pink-600">
                              <%= user.favourites || 0 %>
                            </span>
                            <i class="fas fa-heart text-pink-400 ml-2"></i>
                          </div>
                        </td>
                        <td class="px-6 py-4">
                          <div class="flex items-center">
                            <span class="text-2xl font-bold text-emerald-600">
                              <%= user.bookings || 0 %>
                            </span>
                            <i class="fas fa-calendar-check text-emerald-400 ml-2"></i>
                          </div>
                        </td>
                        <td class="px-6 py-4 text-center">
                          <a
                            href="/admin/user/details/<%= user.id || '#' %>"
                            class="group/btn relative px-6 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 overflow-hidden inline-block"
                          >
                            <div class="absolute inset-0 bg-gradient-to-r from-indigo-600 to-purple-700 opacity-0 group-hover/btn:opacity-100 transition-opacity duration-200"></div>
                            <span class="relative flex items-center">
                              <i class="fas fa-eye mr-2"></i>
                              View Details
                            </span>
                          </a>
                        </td>
                      </tr>
                    <% } %>
                  <% }) %>
                <% } else { %>
                  <!-- Sample User Rows (fallback when no userDetails) -->
                  <tr class="hover:bg-indigo-50 transition-colors duration-200 group">
                    <td class="px-6 py-4">
                      <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mr-3 text-white font-bold">
                          JD
                        </div>
                        <span class="font-semibold text-gray-800">John Doe</span>
                      </div>
                    </td>
                    <td class="px-6 py-4 text-gray-600">john.doe@example.com</td>
                    <td class="px-6 py-4">
                      <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-indigo-100 text-indigo-800">
                        <i class="fas fa-user mr-2"></i>
                        User
                      </span>
                    </td>
                    <td class="px-6 py-4">
                      <div class="flex items-center">
                        <span class="text-2xl font-bold text-pink-600">12</span>
                        <i class="fas fa-heart text-pink-400 ml-2"></i>
                      </div>
                    </td>
                    <td class="px-6 py-4">
                      <div class="flex items-center">
                        <span class="text-2xl font-bold text-emerald-600">5</span>
                        <i class="fas fa-calendar-check text-emerald-400 ml-2"></i>
                      </div>
                    </td>
                    <td class="px-6 py-4 text-center">
                      <button class="group/btn relative px-6 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-r from-indigo-600 to-purple-700 opacity-0 group-hover/btn:opacity-100 transition-opacity duration-200"></div>
                        <span class="relative flex items-center">
                          <i class="fas fa-eye mr-2"></i>
                          View Details
                        </span>
                      </button>
                    </td>
                  </tr>

                  <tr class="hover:bg-indigo-50 transition-colors duration-200 group">
                    <td class="px-6 py-4">
                      <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center mr-3 text-white font-bold">
                          JS
                        </div>
                        <span class="font-semibold text-gray-800">Jane Smith</span>
                      </div>
                    </td>
                    <td class="px-6 py-4 text-gray-600">jane.smith@example.com</td>
                    <td class="px-6 py-4">
                      <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-emerald-100 text-emerald-800">
                        <i class="fas fa-star mr-2"></i>
                        Premium
                      </span>
                    </td>
                    <td class="px-6 py-4">
                      <div class="flex items-center">
                        <span class="text-2xl font-bold text-pink-600">24</span>
                        <i class="fas fa-heart text-pink-400 ml-2"></i>
                      </div>
                    </td>
                    <td class="px-6 py-4">
                      <div class="flex items-center">
                        <span class="text-2xl font-bold text-emerald-600">15</span>
                        <i class="fas fa-calendar-check text-emerald-400 ml-2"></i>
                      </div>
                    </td>
                    <td class="px-6 py-4 text-center">
                      <button class="group/btn relative px-6 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-r from-indigo-600 to-purple-700 opacity-0 group-hover/btn:opacity-100 transition-opacity duration-200"></div>
                        <span class="relative flex items-center">
                          <i class="fas fa-eye mr-2"></i>
                          View Details
                        </span>
                      </button>
                    </td>
                  </tr>
                <% } %>
              </tbody>
            </table>
          </div>
          
          <!-- Pagination -->
          <div class="flex flex-col md:flex-row justify-between items-center mt-8 space-y-4 md:space-y-0">
            <div class="text-sm text-gray-600">
              Showing <span class="font-semibold text-indigo-600">1</span> to <span class="font-semibold text-indigo-600">10</span> of <span class="font-semibold text-indigo-600">97</span> results
            </div>
            <div class="flex items-center space-x-2">
              <button class="px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                <i class="fas fa-chevron-left mr-2"></i>Previous
              </button>
              <button class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-indigo-600 rounded-lg">
                1
              </button>
              <button class="px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                2
              </button>
              <button class="px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                3
              </button>
              <button class="px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200">
                Next<i class="fas fa-chevron-right ml-2"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      function filterTable(searchTerm) {
        const table = document.getElementById('usersTable');
        const rows = table.querySelectorAll('tbody tr');
        
        rows.forEach(row => {
          const text = row.textContent.toLowerCase();
          if (text.includes(searchTerm.toLowerCase())) {
            row.style.display = '';
            row.classList.add('animate-fade-in');
          } else {
            row.style.display = 'none';
            row.classList.remove('animate-fade-in');
          }
        });
      }

      // Add stagger animation to table rows on load
      document.addEventListener('DOMContentLoaded', function() {
        const rows = document.querySelectorAll('tbody tr');
        rows.forEach((row, index) => {
          row.style.animationDelay = `${index * 0.05}s`;
          row.classList.add('animate-slide-up');
        });
      });
    </script>
  </body>
</html>